document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll('.fgb-fluid-group[data-fluid-enabled="true"]').forEach(function(e){const t=e.querySelector(".fgb-fluid-canvas");if(!t)return;const n=e.getAttribute("data-fluid-settings"),o=e.getAttribute("data-initial-shapes");let r={},i=[];try{r=JSON.parse(n)||{}}catch(e){console.error("Failed to parse fluid settings:",e)}try{i=o?JSON.parse(o):[]}catch(e){console.error("Failed to parse initial shapes:",e)}!function(e,t,n=[]){var o,r,i,a,l,s,u,c,f,d,m,v,h,g,p,x,T,E,y,R,b,S,w,M,D,F,_,L,A,B,C,O,U,I,P,X,N,Y,z,k,G,V,H,W,q,$,J,K,j,Q,Z,ee;const te={SIM_RESOLUTION:null!==(o=t.simResolution)&&void 0!==o?o:128,DYE_RESOLUTION:null!==(r=t.dyeResolution)&&void 0!==r?r:1024,DENSITY_DISSIPATION:null!==(i=t.densityDissipation)&&void 0!==i?i:.97,VELOCITY_DISSIPATION:null!==(a=t.velocityDissipation)&&void 0!==a?a:.98,PRESSURE:null!==(l=t.pressure)&&void 0!==l?l:.8,PRESSURE_ITERATIONS:20,CURL:null!==(s=t.curl)&&void 0!==s?s:30,SPLAT_RADIUS:null!==(u=t.splatRadius)&&void 0!==u?u:.25,SPLAT_FORCE:null!==(c=t.splatForce)&&void 0!==c?c:6e3,PROJECTION_DISTANCE:null!==(f=t.projectionDistance)&&void 0!==f?f:1,FADE_SPEED:null!==(d=t.fadeSpeed)&&void 0!==d?d:1,BLOOM:!1!==t.bloom,BLOOM_ITERATIONS:8,BLOOM_RESOLUTION:256,BLOOM_INTENSITY:null!==(m=t.bloomIntensity)&&void 0!==m?m:.8,BLOOM_THRESHOLD:null!==(v=t.bloomThreshold)&&void 0!==v?v:.6,BLOOM_SOFT_KNEE:.7,CALM_DOWN:null!==(h=t.calmDown)&&void 0!==h&&h,CALM_DOWN_DELAY:null!==(g=t.calmDownDelay)&&void 0!==g?g:2e3,CALM_DOWN_STRENGTH:null!==(p=t.calmDownStrength)&&void 0!==p?p:.9},ne={saturation:null!==(x=t.colorSaturation)&&void 0!==x?x:1,brightness:null!==(T=t.colorBrightness)&&void 0!==T?T:.15,saturationBoost:null!==(E=t.saturationBoost)&&void 0!==E?E:1,fixedColor:null!==(y=t.fixedColor)&&void 0!==y?y:"#ff00ff",colorChangeDistance:null!==(R=t.colorChangeDistance)&&void 0!==R?R:0,colorMode:null!==(b=t.colorMode)&&void 0!==b?b:"rainbow",hueMin:null!==(S=t.hueMin)&&void 0!==S?S:0,hueMax:null!==(w=t.hueMax)&&void 0!==w?w:360,gradientSpeed:null!==(M=t.gradientSpeed)&&void 0!==M?M:.5,rainbowMode:!1!==t.rainbowMode,preventOverblending:null!==(D=t.preventOverblending)&&void 0!==D&&D,maxColorIntensity:null!==(F=t.maxColorIntensity)&&void 0!==F?F:1,darkMode:null!==(_=t.darkMode)&&void 0!==_&&_,blendMode:null!==(L=t.blendMode)&&void 0!==L?L:"normal",negativeBloom:null!==(A=t.negativeBloom)&&void 0!==A&&A},oe=t.elementInteraction||{},re={enabled:null!==(B=oe.enabled)&&void 0!==B&&B,selectors:null!==(C=oe.selectors)&&void 0!==C?C:"",trackScroll:null!==(O=oe.trackScroll)&&void 0!==O&&O,mode:null!==(U=oe.mode)&&void 0!==U?U:"hardCorner",softEdgeRadius:null!==(I=oe.softEdgeRadius)&&void 0!==I?I:20,forceFieldStrength:null!==(P=oe.forceFieldStrength)&&void 0!==P?P:50,forceFieldRadius:null!==(X=oe.forceFieldRadius)&&void 0!==X?X:80,attractFieldStrength:null!==(N=oe.attractFieldStrength)&&void 0!==N?N:50,attractFieldRadius:null!==(Y=oe.attractFieldRadius)&&void 0!==Y?Y:80,turbulenceIntensity:null!==(z=oe.turbulenceIntensity)&&void 0!==z?z:30,turbulenceScale:null!==(k=oe.turbulenceScale)&&void 0!==k?k:50,affectNewSplats:!1!==oe.affectNewSplats,affectExistingFluid:null!==(G=oe.affectExistingFluid)&&void 0!==G&&G,edgeGlow:null!==(V=oe.edgeGlow)&&void 0!==V&&V,edgeGlowIntensity:null!==(H=oe.edgeGlowIntensity)&&void 0!==H?H:.5,edgeGlowDistance:null!==(W=oe.edgeGlowDistance)&&void 0!==W?W:15,edgeGlowMatchFluid:null===(q=oe.edgeGlowMatchFluid)||void 0===q||q,edgeGlowColor:null!==($=oe.edgeGlowColor)&&void 0!==$?$:"#ffffff"},ie={mode:null!==(J=t.cursorMode)&&void 0!==J?J:"default",dotSize:null!==(K=t.dotCursor?.size)&&void 0!==K?K:10,dotColor:null!==(j=t.dotCursor?.color)&&void 0!==j?j:"#ffffff",crosshairThickness:null!==(Q=t.crosshairCursor?.thickness)&&void 0!==Q?Q:1,crosshairColor:null!==(Z=t.crosshairCursor?.color)&&void 0!==Z?Z:"#ffffff",siblingHoverMode:null!==(ee=t.siblingHoverMode)&&void 0!==ee&&ee},ae=1,le=1,se=1,ue=1,ce=te.PRESSURE_ITERATIONS,fe=!1,de=60,me=!1;let ve=0,he=[];function ge(){if(re.enabled&&re.selectors)try{const t=document.querySelectorAll(re.selectors);he=Array.from(t).map(t=>function(t){const n=e.getBoundingClientRect(),o=t.getBoundingClientRect();return{x:(o.left-n.left)/n.width,y:1-(o.bottom-n.top)/n.height,width:o.width/n.width,height:o.height/n.height,px:o.left-n.left,py:o.top-n.top,pWidth:o.width,pHeight:o.height}}(t))}catch(e){console.warn("Invalid element selectors:",e),he=[]}else he=[]}let pe=Math.random(),xe=Date.now();e.style.mixBlendMode=ne.blendMode,ne.negativeBloom&&(e.style.filter="invert(1)");class Te{constructor(){this.id=-1,this.texcoordX=0,this.texcoordY=0,this.prevTexcoordX=0,this.prevTexcoordY=0,this.deltaX=0,this.deltaY=0,this.down=!1,this.moved=!1,this.color={r:.5,g:.2,b:.8},this.distanceSinceColorChange=0}}let Ee=[new Te];function ye(e,t,n,o,r){if(!function(e,t,n,o){const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,t,4,4,0,n,o,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(i),e.deleteTexture(r),a===e.FRAMEBUFFER_COMPLETE}(e,t,n,o)){if(r)switch(t){case e.R16F:return ye(e,e.RG16F,e.RG,o,r);case e.RG16F:return ye(e,e.RGBA16F,e.RGBA,o,r)}return{internalFormat:e.RGBA,format:e.RGBA}}return{internalFormat:t,format:n}}const Re=function(e){const t={alpha:!0,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1};let n=e.getContext("webgl2",t);const o=!!n;if(o||(n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)),!n)return console.error("WebGL not supported"),null;let r,i,a,l,s;if(o)n.getExtension("EXT_color_buffer_float"),i=n.getExtension("OES_texture_float_linear"),r=n.HALF_FLOAT;else{const e=n.getExtension("OES_texture_half_float");r=e?e.HALF_FLOAT_OES:n.UNSIGNED_BYTE,i=n.getExtension("OES_texture_half_float_linear")}return n.clearColor(0,0,0,1),o?(a=ye(n,n.RGBA16F,n.RGBA,r,o),l=ye(n,n.RG16F,n.RG,r,o),s=ye(n,n.R16F,n.RED,r,o)):(a={internalFormat:n.RGBA,format:n.RGBA},l={internalFormat:n.RGBA,format:n.RGBA},s={internalFormat:n.RGBA,format:n.RGBA}),{gl:n,ext:{formatRGBA:a,formatRG:l,formatR:s,halfFloatTexType:r,supportLinearFiltering:!!i},isWebGL2:o}}(e);if(!Re)return;const{gl:be,ext:Se,isWebGL2:we}=Re;function Me(e,t){const n=be.createShader(e);return be.shaderSource(n,t),be.compileShader(n),be.getShaderParameter(n,be.COMPILE_STATUS)?n:(console.error("Shader error:",be.getShaderInfoLog(n)),be.deleteShader(n),null)}function De(e,t){const n=Me(be.VERTEX_SHADER,e),o=Me(be.FRAGMENT_SHADER,t);if(!n||!o)return null;const r=be.createProgram();if(be.attachShader(r,n),be.attachShader(r,o),be.linkProgram(r),!be.getProgramParameter(r,be.LINK_STATUS))return console.error("Program error:",be.getProgramInfoLog(r)),null;const i={},a=be.getProgramParameter(r,be.ACTIVE_UNIFORMS);for(let e=0;e<a;e++){const t=be.getActiveUniform(r,e).name;i[t]=be.getUniformLocation(r,t)}return{program:r,uniforms:i}}const Fe="\n        precision highp float;\n        attribute vec2 aPosition;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform vec2 texelSize;\n        \n        void main () {\n            vUv = aPosition * 0.5 + 0.5;\n            vL = vUv - vec2(texelSize.x, 0.0);\n            vR = vUv + vec2(texelSize.x, 0.0);\n            vT = vUv + vec2(0.0, texelSize.y);\n            vB = vUv - vec2(0.0, texelSize.y);\n            gl_Position = vec4(aPosition, 0.0, 1.0);\n        }\n    ",_e="\n        precision highp float;\n        attribute vec2 aPosition;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        uniform vec2 texelSize;\n        \n        void main () {\n            vUv = aPosition * 0.5 + 0.5;\n            float offset = 1.33333333;\n            vL = vUv - texelSize * offset;\n            vR = vUv + texelSize * offset;\n            gl_Position = vec4(aPosition, 0.0, 1.0);\n        }\n    ",Le={copy:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        \n        void main () {\n            gl_FragColor = texture2D(uTexture, vUv);\n        }\n    "),clear:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float value;\n        \n        void main () {\n            gl_FragColor = value * texture2D(uTexture, vUv);\n        }\n    "),display:De(Fe,"\n        precision highp float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform sampler2D uBloom;\n        uniform bool useBloom;\n        \n        void main () {\n            vec3 c = texture2D(uTexture, vUv).rgb;\n            if (useBloom) {\n                vec3 bloom = texture2D(uBloom, vUv).rgb;\n                c += bloom;\n            }\n            float a = max(c.r, max(c.g, c.b));\n            gl_FragColor = vec4(c, a);\n        }\n    "),bloomPrefilter:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec3 curve;\n        uniform float threshold;\n        \n        void main () {\n            vec3 c = texture2D(uTexture, vUv).rgb;\n            float br = max(c.r, max(c.g, c.b));\n            float rq = clamp(br - curve.x, 0.0, curve.y);\n            rq = curve.z * rq * rq;\n            c *= max(rq, br - threshold) / max(br, 0.0001);\n            gl_FragColor = vec4(c, 0.0);\n        }\n    "),bloomBlur:De(_e,"\n        precision mediump float;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        \n        void main () {\n            vec4 sum = vec4(0.0);\n            sum += texture2D(uTexture, vL);\n            sum += texture2D(uTexture, vR);\n            sum *= 0.5;\n            gl_FragColor = sum;\n        }\n    "),bloomFinal:De(_e,"\n        precision mediump float;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float intensity;\n        \n        void main () {\n            vec4 sum = vec4(0.0);\n            sum += texture2D(uTexture, vL);\n            sum += texture2D(uTexture, vR);\n            sum *= 0.5 * intensity;\n            gl_FragColor = sum;\n        }\n    "),splat:De(Fe,"\n        precision highp float;\n        varying vec2 vUv;\n        uniform sampler2D uTarget;\n        uniform float aspectRatio;\n        uniform vec3 color;\n        uniform vec2 point;\n        uniform float radius;\n        \n        void main () {\n            vec2 p = vUv - point.xy;\n            p.x *= aspectRatio;\n            vec3 splat = exp(-dot(p, p) / radius) * color;\n            vec3 base = texture2D(uTarget, vUv).xyz;\n            gl_FragColor = vec4(base + splat, 1.0);\n        }\n    "),advection:De(Fe,"\n        precision highp float;\n        varying vec2 vUv;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uSource;\n        uniform vec2 texelSize;\n        uniform vec2 dyeTexelSize;\n        uniform float dt;\n        uniform float dissipation;\n        \n        void main () {\n            vec2 coord = vUv - dt * texture2D(uVelocity, vUv).xy * texelSize;\n            vec4 result = texture2D(uSource, coord);\n            float decay = 1.0 + dissipation * dt;\n            gl_FragColor = result / decay;\n        }\n    "),divergence:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        \n        void main () {\n            float L = texture2D(uVelocity, vL).x;\n            float R = texture2D(uVelocity, vR).x;\n            float T = texture2D(uVelocity, vT).y;\n            float B = texture2D(uVelocity, vB).y;\n            vec2 C = texture2D(uVelocity, vUv).xy;\n            if (vL.x < 0.0) { L = -C.x; }\n            if (vR.x > 1.0) { R = -C.x; }\n            if (vT.y > 1.0) { T = -C.y; }\n            if (vB.y < 0.0) { B = -C.y; }\n            float div = 0.5 * (R - L + T - B);\n            gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n        }\n    "),curl:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        \n        void main () {\n            float L = texture2D(uVelocity, vL).y;\n            float R = texture2D(uVelocity, vR).y;\n            float T = texture2D(uVelocity, vT).x;\n            float B = texture2D(uVelocity, vB).x;\n            float vorticity = R - L - T + B;\n            gl_FragColor = vec4(0.5 * vorticity, 0.0, 0.0, 1.0);\n        }\n    "),vorticity:De(Fe,"\n        precision highp float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uCurl;\n        uniform float curl;\n        uniform float dt;\n        \n        void main () {\n            float L = texture2D(uCurl, vL).x;\n            float R = texture2D(uCurl, vR).x;\n            float T = texture2D(uCurl, vT).x;\n            float B = texture2D(uCurl, vB).x;\n            float C = texture2D(uCurl, vUv).x;\n            vec2 force = 0.5 * vec2(abs(T) - abs(B), abs(R) - abs(L));\n            force /= length(force) + 0.0001;\n            force *= curl * C;\n            force.y *= -1.0;\n            vec2 vel = texture2D(uVelocity, vUv).xy;\n            gl_FragColor = vec4(vel + force * dt, 0.0, 1.0);\n        }\n    "),pressure:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uPressure;\n        uniform sampler2D uDivergence;\n        \n        void main () {\n            float L = texture2D(uPressure, vL).x;\n            float R = texture2D(uPressure, vR).x;\n            float T = texture2D(uPressure, vT).x;\n            float B = texture2D(uPressure, vB).x;\n            float C = texture2D(uPressure, vUv).x;\n            float divergence = texture2D(uDivergence, vUv).x;\n            float pressure = (L + R + B + T - divergence) * 0.25;\n            gl_FragColor = vec4(pressure, 0.0, 0.0, 1.0);\n        }\n    "),gradientSubtract:De(Fe,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uPressure;\n        uniform sampler2D uVelocity;\n        \n        void main () {\n            float L = texture2D(uPressure, vL).x;\n            float R = texture2D(uPressure, vR).x;\n            float T = texture2D(uPressure, vT).x;\n            float B = texture2D(uPressure, vB).x;\n            vec2 velocity = texture2D(uVelocity, vUv).xy;\n            velocity.xy -= vec2(R - L, T - B);\n            gl_FragColor = vec4(velocity, 0.0, 1.0);\n        }\n    ")},Ae=be.createBuffer();be.bindBuffer(be.ARRAY_BUFFER,Ae),be.bufferData(be.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),be.STATIC_DRAW);const Be=be.createBuffer();function Ce(e,t=!1){null==e?(be.viewport(0,0,be.drawingBufferWidth,be.drawingBufferHeight),be.bindFramebuffer(be.FRAMEBUFFER,null)):(be.viewport(0,0,e.width,e.height),be.bindFramebuffer(be.FRAMEBUFFER,e.fbo)),t&&(be.clearColor(0,0,0,1),be.clear(be.COLOR_BUFFER_BIT)),be.bindBuffer(be.ARRAY_BUFFER,Ae),be.bindBuffer(be.ELEMENT_ARRAY_BUFFER,Be),be.enableVertexAttribArray(0),be.vertexAttribPointer(0,2,be.FLOAT,!1,0,0),be.drawElements(be.TRIANGLES,6,be.UNSIGNED_SHORT,0)}let Oe,Ue,Ie,Pe,Xe,Ne;be.bindBuffer(be.ELEMENT_ARRAY_BUFFER,Be),be.bufferData(be.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),be.STATIC_DRAW);let Ye=[];function ze(e){let t=be.drawingBufferWidth/be.drawingBufferHeight;t<1&&(t=1/t);const n=Math.round(e),o=Math.round(e*t);return be.drawingBufferWidth>be.drawingBufferHeight?{width:o,height:n}:{width:n,height:o}}function ke(e,t,n,o,r,i){be.activeTexture(be.TEXTURE0);const a=be.createTexture();be.bindTexture(be.TEXTURE_2D,a),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MIN_FILTER,i),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MAG_FILTER,i),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texImage2D(be.TEXTURE_2D,0,n,e,t,0,o,r,null);const l=be.createFramebuffer();return be.bindFramebuffer(be.FRAMEBUFFER,l),be.framebufferTexture2D(be.FRAMEBUFFER,be.COLOR_ATTACHMENT0,be.TEXTURE_2D,a,0),be.viewport(0,0,e,t),be.clear(be.COLOR_BUFFER_BIT),{texture:a,fbo:l,width:e,height:t,texelSizeX:1/e,texelSizeY:1/t,attach:e=>(be.activeTexture(be.TEXTURE0+e),be.bindTexture(be.TEXTURE_2D,a),e)}}function Ge(e,t,n,o,r,i){let a=ke(e,t,n,o,r,i),l=ke(e,t,n,o,r,i);return{width:e,height:t,texelSizeX:a.texelSizeX,texelSizeY:a.texelSizeY,get read(){return a},set read(e){a=e},get write(){return l},set write(e){l=e},swap(){const e=a;a=l,l=e}}}const Ve=e.closest(".fgb-fluid-group");let He,We=0,qe=0;function $e(){const t=Ve.offsetWidth||300,n=Ve.offsetHeight||200;if(Math.abs(t-We)>1||Math.abs(n-qe)>1){const o=4096,r=Math.min(Math.max(t,100),o),i=Math.min(Math.max(n,100),o);return e.width=r,e.height=i,We=t,qe=n,!0}return!1}function Je(){const e=ze(te.SIM_RESOLUTION),t=ze(te.DYE_RESOLUTION),n=Se.halfFloatTexType,o=Se.formatRGBA,r=Se.formatRG,i=Se.formatR,a=Se.supportLinearFiltering?be.LINEAR:be.NEAREST;Oe=Ge(t.width,t.height,o.internalFormat,o.format,n,a),Ue=Ge(e.width,e.height,r.internalFormat,r.format,n,a),Ie=ke(e.width,e.height,i.internalFormat,i.format,n,be.NEAREST),Pe=ke(e.width,e.height,i.internalFormat,i.format,n,be.NEAREST),Xe=Ge(e.width,e.height,i.internalFormat,i.format,n,be.NEAREST),function(){const e=ze(te.BLOOM_RESOLUTION),t=Se.halfFloatTexType,n=Se.formatRGBA,o=Se.supportLinearFiltering?be.LINEAR:be.NEAREST;Ne=ke(e.width,e.height,n.internalFormat,n.format,t,o),Ye.length=0;for(let r=0;r<te.BLOOM_ITERATIONS;r++){const i=e.width>>r+1,a=e.height>>r+1;if(i<2||a<2)break;const l=ke(i,a,n.internalFormat,n.format,t,o);Ye.push(l)}}()}function Ke(){let e;const t=Math.min(ne.saturation*ne.saturationBoost,1);switch(ne.colorMode||"rainbow"){case"rainbow":e=je(Math.random(),t,1);break;case"huerange":const n=ne.hueMin/360,o=ne.hueMax/360;let r;if(n<=o)r=n+Math.random()*(o-n);else{const e=1-n+o;r=n+Math.random()*e,r>1&&(r-=1)}e=je(r,t,1);break;case"gradient":pe+=.01*ne.gradientSpeed,pe>1&&(pe-=1),e=je(pe,t,1);break;default:e=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:{r:1,g:0,b:1}}(ne.fixedColor||"#ff00ff")}if(e.r*=ne.brightness,e.g*=ne.brightness,e.b*=ne.brightness,ne.preventOverblending){const t=ne.maxColorIntensity;e.r=Math.min(e.r,t),e.g=Math.min(e.g,t),e.b=Math.min(e.b,t)}return ne.darkMode&&(e.r=-e.r,e.g=-e.g,e.b=-e.b),e}function je(e,t,n){let o,r,i;const a=Math.floor(6*e),l=6*e-a,s=n*(1-t),u=n*(1-l*t),c=n*(1-(1-l)*t);switch(a%6){case 0:o=n,r=c,i=s;break;case 1:o=u,r=n,i=s;break;case 2:o=s,r=n,i=c;break;case 3:o=s,r=u,i=n;break;case 4:o=c,r=s,i=n;break;case 5:o=n,r=s,i=u}return{r:o,g:r,b:i}}window.addEventListener("resize",function(){clearTimeout(He),He=setTimeout(function(){$e()&&Je(),ge()},100)}),re.enabled&&re.trackScroll&&window.addEventListener("scroll",function(){ge()},{passive:!0}),re.enabled&&setTimeout(ge,200),$e(),Je();let Qe=Date.now();function Ze(t,n,o,r,i){xe=Date.now(),be.useProgram(Le.splat.program),be.uniform1i(Le.splat.uniforms.uTarget,Ue.read.attach(0)),be.uniform1f(Le.splat.uniforms.aspectRatio,e.width/e.height),be.uniform2f(Le.splat.uniforms.point,t,n),be.uniform3f(Le.splat.uniforms.color,o,r,0),be.uniform1f(Le.splat.uniforms.radius,function(t){const n=e.width/e.height;return n>1&&(t*=n),t}(te.SPLAT_RADIUS/100)),Ce(Ue.write),Ue.swap(),be.uniform1i(Le.splat.uniforms.uTarget,Oe.read.attach(0)),be.uniform3f(Le.splat.uniforms.color,i.r,i.g,i.b),Ce(Oe.write),Oe.swap()}ie.siblingHoverMode?(document.addEventListener("mousemove",t=>{const n=e.getBoundingClientRect();t.clientX>=n.left&&t.clientX<=n.right&&t.clientY>=n.top&&t.clientY<=n.bottom&&it(Ee[0],t.clientX-n.left,t.clientY-n.top)}),document.addEventListener("mousedown",t=>{const n=e.getBoundingClientRect();if(t.clientX>=n.left&&t.clientX<=n.right&&t.clientY>=n.top&&t.clientY<=n.bottom){const e=Ee[0];e.down=!0,e.color=Ke()}}),document.addEventListener("mouseup",()=>{Ee[0].down=!1})):(Ve.addEventListener("mousemove",t=>{const n=Ee[0],o=e.getBoundingClientRect();it(n,t.clientX-o.left,t.clientY-o.top)}),Ve.addEventListener("mousedown",()=>{const e=Ee[0];e.down=!0,e.color=Ke()}),Ve.addEventListener("mouseup",()=>{Ee[0].down=!1}));let et=null,tt=null,nt=null;function ot(e,t,n){const o=ie.mode;"dot"===o&&et?n?(et.style.display="block",et.style.left=e+"px",et.style.top=t+"px"):et.style.display="none":"crosshair"===o&&tt&&nt&&(n?(tt.style.display="block",nt.style.display="block",tt.style.top=t+"px",nt.style.left=e+"px"):(tt.style.display="none",nt.style.display="none"))}function rt(t,n,o,r){t.id=n,t.down=!0,t.moved=!1,t.texcoordX=o/e.width,t.texcoordY=1-r/e.height,t.prevTexcoordX=t.texcoordX,t.prevTexcoordY=t.texcoordY,t.deltaX=0,t.deltaY=0,t.color=Ke()}function it(t,n,o){if(t.prevTexcoordX=t.texcoordX,t.prevTexcoordY=t.texcoordY,t.texcoordX=n/e.width,t.texcoordY=1-o/e.height,t.deltaX=function(t){const n=e.width/e.height;return n<1&&(t*=n),t}(t.texcoordX-t.prevTexcoordX),t.deltaY=function(t){const n=e.width/e.height;return(n>1||n<1)&&(t/=n),t}(t.texcoordY-t.prevTexcoordY),t.moved=Math.abs(t.deltaX)>0||Math.abs(t.deltaY)>0,t.moved){const n=t.deltaX*e.width,o=t.deltaY*e.height,r=Math.sqrt(n*n+o*o);t.distanceSinceColorChange+=r;const i=ne.colorChangeDistance;(0===i||t.distanceSinceColorChange>=i)&&(t.color=Ke(),t.distanceSinceColorChange=0)}}"default"!==ie.mode&&(function(){const e=ie.mode;"hidden"===e?Ve.style.cursor="none":"dot"===e?(Ve.style.cursor="none",et=document.createElement("div"),et.className="fgb-dot-cursor",et.style.cssText=`\n                position: fixed;\n                pointer-events: none;\n                z-index: 999999;\n                width: ${ie.dotSize}px;\n                height: ${ie.dotSize}px;\n                background-color: ${ie.dotColor};\n                border-radius: 50%;\n                transform: translate(-50%, -50%);\n                display: none;\n            `,document.body.appendChild(et)):"crosshair"===e&&(Ve.style.cursor="none",tt=document.createElement("div"),tt.className="fgb-crosshair-h",tt.style.cssText=`\n                position: fixed;\n                left: 0;\n                right: 0;\n                height: ${ie.crosshairThickness}px;\n                background-color: ${ie.crosshairColor};\n                pointer-events: none;\n                z-index: 999999;\n                display: none;\n            `,document.body.appendChild(tt),nt=document.createElement("div"),nt.className="fgb-crosshair-v",nt.style.cssText=`\n                position: fixed;\n                top: 0;\n                bottom: 0;\n                width: ${ie.crosshairThickness}px;\n                background-color: ${ie.crosshairColor};\n                pointer-events: none;\n                z-index: 999999;\n                display: none;\n            `,document.body.appendChild(nt))}(),Ve.addEventListener("mouseenter",()=>{"dot"===ie.mode&&et?et.style.display="block":"crosshair"===ie.mode&&(tt&&(tt.style.display="block"),nt&&(nt.style.display="block"))}),Ve.addEventListener("mouseleave",()=>{ot(0,0,!1)}),window.addEventListener("mousemove",e=>{const t=Ve.getBoundingClientRect(),n=e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom;ot(e.clientX,e.clientY,n)})),document.addEventListener("touchstart",t=>{const n=t.touches;for(;n.length>=Ee.length;)Ee.push(new Te);for(let t=0;t<n.length;t++){const o=e.getBoundingClientRect(),r=(n[t].clientX-o.left)*(e.width/o.width),i=(n[t].clientY-o.top)*(e.height/o.height);rt(Ee[t+1],n[t].identifier,r,i)}},{passive:!0}),document.addEventListener("touchmove",t=>{const n=t.touches;for(let t=0;t<n.length;t++){const o=Ee[t+1];if(!o||!o.down)continue;const r=e.getBoundingClientRect();it(o,(n[t].clientX-r.left)*(e.width/r.width),(n[t].clientY-r.top)*(e.height/r.height))}},{passive:!0}),document.addEventListener("touchend",e=>{const t=e.changedTouches;for(let e=0;e<t.length;e++){const n=Ee.find(n=>n.id===t[e].identifier);n&&(n.down=!1)}},{passive:!0}),n&&0!==n.length?n.forEach(t=>{const n=e=>!e||e.length<2?0:e[0]+Math.random()*(e[1]-e[0]),o=t.timing?.delay||0,r=t.timing?.duration||500,i=t.timing?.repeat||0,a=t.timing?.repeatDelay||0,l=!1!==t.randomizeColor?null:Ke(),s=()=>{const o=(t.x+n(t.random?.x))/100,i=1-(t.y+n(t.random?.y))/100,a=n(t.random?.angle)*(Math.PI/180),s=n(t.random?.speed),u=(t.props?.speed||1)+s,c=1+n(t.random?.size)/100,f=n(t.random?.force),d=(t.force||1)+f,m=function(t,n,o,r,i=1){const a=[],l=t.props||{},s=i||1;switch(t.type){case"stroke":{const t=(l.length||100)*s/e.width,i=(l.angle||0)*Math.PI/180+r,u=30;for(let e=0;e<=u;e++){const r=e/u;a.push({x:n+(r-.5)*t*Math.cos(i),y:o+(r-.5)*t*Math.sin(i)})}break}case"circle":{const t=(l.radius||50)*s/e.width,i=36;for(let e=0;e<=i;e++){const l=e/i*Math.PI*2+r;a.push({x:n+Math.cos(l)*t,y:o+Math.sin(l)*t})}break}case"ellipse":{const t=(l.radiusX||60)*s/e.width,i=(l.radiusY||40)*s/e.height,u=(l.rotation||0)*Math.PI/180+r,c=36;for(let e=0;e<=c;e++){const r=e/c*Math.PI*2,l=Math.cos(r)*t,s=Math.sin(r)*i;a.push({x:n+l*Math.cos(u)-s*Math.sin(u),y:o+l*Math.sin(u)+s*Math.cos(u)})}break}case"rectangle":{const t=(l.width||80)*s/e.width,i=(l.height||50)*s/e.height,u=(l.rotation||0)*Math.PI/180+r,c=[[-t/2,-i/2],[t/2,-i/2],[t/2,i/2],[-t/2,i/2],[-t/2,-i/2]],f=8;for(let e=0;e<4;e++)for(let t=0;t<=f;t++){const r=t/f,i=c[e][0]+r*(c[e+1][0]-c[e][0]),l=c[e][1]+r*(c[e+1][1]-c[e][1]);a.push({x:n+i*Math.cos(u)-l*Math.sin(u),y:o+i*Math.sin(u)+l*Math.cos(u)})}break}case"svg":case"path":{const e=l.pathData||l.points||"",t=(l.rotation||0)*Math.PI/180+r,i=l.scale||1;let s=[],u=!1;if(Array.isArray(e))s=e,u=!0;else if("string"==typeof e){const t=e.match(/[-\d.]+/g);if(t)for(let e=0;e<t.length-1;e+=2)s.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])})}if(u&&s.length>0){const e=s.reduce((e,t)=>e+t.x,0)/s.length,n=s.reduce((e,t)=>e+t.y,0)/s.length;for(const o of s){const r=(e+(o.x-e)*i)/100-.5,l=1-(n+(o.y-n)*i)/100-.5;a.push({x:.5+r*Math.cos(t)-l*Math.sin(t),y:.5+r*Math.sin(t)+l*Math.cos(t)})}}else for(const e of s){const r=.002*i,l=e.x*r,s=e.y*r;a.push({x:n+l*Math.cos(t)-s*Math.sin(t),y:o+l*Math.sin(t)+s*Math.cos(t)})}break}}return a}(t,o,i,a,c);let v;v="fixed"===t.colorMode&&t.color?(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null})(t.color)||Ke():l||Ke(),function(e,t,n,o,r,i){if(e.length<2)return;const a=performance.now(),l=400*n*(r||1);let s=e[0].x,u=e[0].y;const c=i||0;requestAnimationFrame(function n(r){const i=r-a,f=Math.min(i/t,1),d=f*(e.length-1),m=Math.floor(d),v=d-m,h=e[Math.min(m,e.length-1)],g=e[Math.min(m+1,e.length-1)],p=v*v*(3-2*v),x=h.x+p*(g.x-h.x),T=h.y+p*(g.y-h.y),E=(x-s)*l,y=(T-u)*l;let R=o;if(c>0){const e=f*c;R={r:(o.r+.5*e)%1,g:(o.g+.3*e)%1,b:(o.b+.7*e)%1}}(Math.abs(E)>.01||Math.abs(y)>.01)&&Ze(x,T,E,y,R),s=x,u=T,f<1&&requestAnimationFrame(n)})}(m,r,u,v,d,t.colorSpeed)},u=e=>{setTimeout(s,o+e*(r+a))};u(0);for(let e=1;e<=i;e++)u(e)}):function(e){for(let t=0;t<e;t++){const e=Ke();e.r*=10,e.g*=10,e.b*=10,Ze(Math.random(),Math.random(),1e3*(Math.random()-.5),1e3*(Math.random()-.5),e)}}(parseInt(5*Math.random())+5),function t(n){if(me)return void requestAnimationFrame(t);if(fe){if(n-ve<1e3/de)return void requestAnimationFrame(t);ve=n}const o=function(){const e=Date.now();let t=(e-Qe)/1e3;return t=Math.min(t,.016666),Qe=e,t*ae}();var r;Ee.forEach(t=>{t.moved&&(t.moved=!1,function(t){let n=t.deltaX*te.SPLAT_FORCE*te.PROJECTION_DISTANCE*le,o=t.deltaY*te.SPLAT_FORCE*te.PROJECTION_DISTANCE*le,r=t.color;if(re.enabled&&re.affectNewSplats){const i=function(t,n){if(!re.enabled||0===he.length)return{blocked:!1,forceX:0,forceY:0,opacity:1};const o=re.mode;let r={blocked:!1,forceX:0,forceY:0,opacity:1};for(const i of he){const a=t>=i.x&&t<=i.x+i.width,l=n>=i.y&&n<=i.y+i.height,s=a&&l,u=i.x+i.width/2,c=i.y+i.height/2,f=(e.width,e.height,(t-u)*e.width),d=(n-c)*e.height,m=Math.sqrt(f*f+d*d),v=i.pWidth/2,h=i.pHeight/2,g=s?0:Math.max(0,Math.min(Math.abs((t-u)*e.width)-v,Math.abs((n-c)*e.height)-h));switch(o){case"hardCorner":s&&(r.blocked=!0,r.opacity=0);break;case"softEdge":const e=re.softEdgeRadius;s?(r.blocked=!0,r.opacity=0):g<e&&(r.opacity=Math.min(r.opacity,g/e));break;case"forceField":const t=re.forceFieldRadius;if(m<t+v){const e=(1-m/(t+v))*re.forceFieldStrength,n=Math.atan2(d,f);r.forceX+=Math.cos(n)*e,r.forceY+=Math.sin(n)*e}s&&(r.blocked=!0);break;case"attractField":const n=re.attractFieldRadius;if(m<n+v&&!s){const e=(1-m/(n+v))*re.attractFieldStrength,t=Math.atan2(d,f);r.forceX-=Math.cos(t)*e,r.forceY-=Math.sin(t)*e}break;case"turbulence":const o=i.pWidth,a=re.turbulenceIntensity,l=re.turbulenceScale;if(m<2*o&&!s){const e=Math.atan2(d,f)+Math.PI/2,t=(1-m/(2*o))*a;r.forceX+=Math.cos(e)*t*(.5*Math.sin(Date.now()/l)+.5),r.forceY+=Math.sin(e)*t*(.5*Math.cos(Date.now()/l)+.5)}}}return r}(t.texcoordX,t.texcoordY);if(i.blocked)return;n+=i.forceX,o+=i.forceY,r={r:t.color.r*i.opacity,g:t.color.g*i.opacity,b:t.color.b*i.opacity}}Ze(t.texcoordX,t.texcoordY,n,o,r)}(t))}),function(t){be.disable(be.BLEND),be.useProgram(Le.curl.program),be.uniform2f(Le.curl.uniforms.texelSize,Ue.texelSizeX,Ue.texelSizeY),be.uniform1i(Le.curl.uniforms.uVelocity,Ue.read.attach(0)),Ce(Pe),be.useProgram(Le.vorticity.program),be.uniform2f(Le.vorticity.uniforms.texelSize,Ue.texelSizeX,Ue.texelSizeY),be.uniform1i(Le.vorticity.uniforms.uVelocity,Ue.read.attach(0)),be.uniform1i(Le.vorticity.uniforms.uCurl,Pe.attach(1)),be.uniform1f(Le.vorticity.uniforms.curl,te.CURL*ue),be.uniform1f(Le.vorticity.uniforms.dt,t),Ce(Ue.write),Ue.swap(),be.useProgram(Le.divergence.program),be.uniform2f(Le.divergence.uniforms.texelSize,Ue.texelSizeX,Ue.texelSizeY),be.uniform1i(Le.divergence.uniforms.uVelocity,Ue.read.attach(0)),Ce(Ie),be.useProgram(Le.clear.program),be.uniform1i(Le.clear.uniforms.uTexture,Xe.read.attach(0)),be.uniform1f(Le.clear.uniforms.value,te.PRESSURE),Ce(Xe.write),Xe.swap(),be.useProgram(Le.pressure.program),be.uniform2f(Le.pressure.uniforms.texelSize,Ue.texelSizeX,Ue.texelSizeY),be.uniform1i(Le.pressure.uniforms.uDivergence,Ie.attach(0));for(let e=0;e<ce;e++)be.uniform1i(Le.pressure.uniforms.uPressure,Xe.read.attach(1)),Ce(Xe.write),Xe.swap();be.useProgram(Le.gradientSubtract.program),be.uniform2f(Le.gradientSubtract.uniforms.texelSize,Ue.texelSizeX,Ue.texelSizeY),be.uniform1i(Le.gradientSubtract.uniforms.uPressure,Xe.read.attach(0)),be.uniform1i(Le.gradientSubtract.uniforms.uVelocity,Ue.read.attach(1)),Ce(Ue.write),Ue.swap(),be.useProgram(Le.advection.program),be.uniform2f(Le.advection.uniforms.texelSize,Ue.texelSizeX,Ue.texelSizeY),be.uniform2f(Le.advection.uniforms.dyeTexelSize,Ue.texelSizeX,Ue.texelSizeY);const n=Ue.read.attach(0);be.uniform1i(Le.advection.uniforms.uVelocity,n),be.uniform1i(Le.advection.uniforms.uSource,n),be.uniform1f(Le.advection.uniforms.dt,t);let o=te.VELOCITY_DISSIPATION;if(te.CALM_DOWN){const e=Date.now()-xe;if(e>te.CALM_DOWN_DELAY){const t=Math.min((e-te.CALM_DOWN_DELAY)/1e3,1);o=te.VELOCITY_DISSIPATION*(1-t)+te.CALM_DOWN_STRENGTH*t}}be.uniform1f(Le.advection.uniforms.dissipation,o),Ce(Ue.write),Ue.swap(),be.uniform2f(Le.advection.uniforms.dyeTexelSize,Oe.texelSizeX,Oe.texelSizeY),be.uniform1i(Le.advection.uniforms.uVelocity,Ue.read.attach(0)),be.uniform1i(Le.advection.uniforms.uSource,Oe.read.attach(1));const r=te.DENSITY_DISSIPATION/te.FADE_SPEED*se;be.uniform1f(Le.advection.uniforms.dissipation,r),Ce(Oe.write),Oe.swap(),re.enabled&&re.affectExistingFluid&&he.length>0&&function(){const t=re.mode;for(const n of he){const o=n.x+n.width/2,r=n.y+n.height/2;switch(t){case"hardCorner":case"softEdge":const i="softEdge"===t?.5*Math.max(n.width,n.height)+re.softEdgeRadius/e.width:.4*Math.max(n.width,n.height);be.useProgram(Le.splat.program),be.uniform1i(Le.splat.uniforms.uTarget,Ue.read.attach(0)),be.uniform1f(Le.splat.uniforms.aspectRatio,e.width/e.height),be.uniform2f(Le.splat.uniforms.point,o,r),be.uniform3f(Le.splat.uniforms.color,0,0,0),be.uniform1f(Le.splat.uniforms.radius,.5*i),Ce(Ue.write),Ue.swap(),be.uniform1i(Le.splat.uniforms.uTarget,Oe.read.attach(0));const a="softEdge"===t?-.02:-.05;be.uniform3f(Le.splat.uniforms.color,a,a,a),be.uniform1f(Le.splat.uniforms.radius,.5*i),Ce(Oe.write),Oe.swap();break;case"forceField":const l=re.forceFieldRadius/e.width+.5*n.width,s=.01*re.forceFieldStrength;be.useProgram(Le.splat.program),be.uniform1i(Le.splat.uniforms.uTarget,Ue.read.attach(0)),be.uniform1f(Le.splat.uniforms.aspectRatio,e.width/e.height),be.uniform2f(Le.splat.uniforms.point,o,r),be.uniform3f(Le.splat.uniforms.color,s,s,0),be.uniform1f(Le.splat.uniforms.radius,l),Ce(Ue.write),Ue.swap();break;case"attractField":const u=re.attractFieldRadius/e.width+.5*n.width,c=.005*-re.attractFieldStrength;be.useProgram(Le.splat.program),be.uniform1i(Le.splat.uniforms.uTarget,Ue.read.attach(0)),be.uniform1f(Le.splat.uniforms.aspectRatio,e.width/e.height),be.uniform2f(Le.splat.uniforms.point,o,r),be.uniform3f(Le.splat.uniforms.color,c,c,0),be.uniform1f(Le.splat.uniforms.radius,u),Ce(Ue.write),Ue.swap();break;case"turbulence":const f=n.width+re.turbulenceIntensity/e.width,d=.001*re.turbulenceIntensity,m=Date.now()/re.turbulenceScale,v=Math.sin(m)*d;be.useProgram(Le.splat.program),be.uniform1i(Le.splat.uniforms.uTarget,Ue.read.attach(0)),be.uniform1f(Le.splat.uniforms.aspectRatio,e.width/e.height),be.uniform2f(Le.splat.uniforms.point,o,r),be.uniform3f(Le.splat.uniforms.color,v,.5*-v,0),be.uniform1f(Le.splat.uniforms.radius,f),Ce(Ue.write),Ue.swap()}}}()}(o),r=null,te.BLOOM&&Ye.length>=2&&function(e,t){if(Ye.length<2)return;let n=t;be.disable(be.BLEND),be.useProgram(Le.bloomPrefilter.program);const o=te.BLOOM_THRESHOLD*te.BLOOM_SOFT_KNEE+1e-4,r=te.BLOOM_THRESHOLD-o,i=2*o,a=.25/o;be.uniform3f(Le.bloomPrefilter.uniforms.curve,r,i,a),be.uniform1f(Le.bloomPrefilter.uniforms.threshold,te.BLOOM_THRESHOLD),be.uniform1i(Le.bloomPrefilter.uniforms.uTexture,e.attach(0)),Ce(n),be.useProgram(Le.bloomBlur.program);for(let e=0;e<Ye.length;e++){const t=Ye[e];be.uniform2f(Le.bloomBlur.uniforms.texelSize,n.texelSizeX,n.texelSizeY),be.uniform1i(Le.bloomBlur.uniforms.uTexture,n.attach(0)),Ce(t),n=t}be.blendFunc(be.ONE,be.ONE),be.enable(be.BLEND);for(let e=Ye.length-2;e>=0;e--){const t=Ye[e];be.uniform2f(Le.bloomBlur.uniforms.texelSize,n.texelSizeX,n.texelSizeY),be.uniform1i(Le.bloomBlur.uniforms.uTexture,n.attach(0)),be.viewport(0,0,t.width,t.height),Ce(t),n=t}be.disable(be.BLEND),be.useProgram(Le.bloomFinal.program),be.uniform2f(Le.bloomFinal.uniforms.texelSize,n.texelSizeX,n.texelSizeY),be.uniform1i(Le.bloomFinal.uniforms.uTexture,n.attach(0)),be.uniform1f(Le.bloomFinal.uniforms.intensity,te.BLOOM_INTENSITY),Ce(t)}(Oe.read,Ne),function(e){const t=null==e?be.drawingBufferWidth:e.width,n=null==e?be.drawingBufferHeight:e.height;be.useProgram(Le.display.program),be.uniform2f(Le.display.uniforms.texelSize,1/t,1/n),be.uniform1i(Le.display.uniforms.uTexture,Oe.read.attach(0)),te.BLOOM&&Ye.length>=2?(be.uniform1i(Le.display.uniforms.uBloom,Ne.attach(1)),be.uniform1i(Le.display.uniforms.useBloom,1)):be.uniform1i(Le.display.uniforms.useBloom,0),Ce(e)}(r),requestAnimationFrame(t)}()}(t,r,i)})});