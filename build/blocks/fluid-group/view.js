(()=>{function e(){document.querySelectorAll('.fgb-fluid-group[data-fluid-enabled="true"]').forEach(function(e){if("true"===e.dataset.fluidInitialized)return;const t=e.querySelector(".fgb-fluid-canvas");if(!t)return;const n=e.getAttribute("data-fluid-settings"),o=e.getAttribute("data-initial-shapes");let r={},i=[];try{r=JSON.parse(n)||{}}catch(e){console.error("Failed to parse fluid settings:",e)}try{i=o?JSON.parse(o):[]}catch(e){console.error("Failed to parse initial shapes:",e)}!function(e,t,n=[]){var o,r,i,a,l,s,u,c,d,f,m,v,h,g,p,x,E,T,R,y,b,S,w,M,D,F,_,L,A,B,C,O,I,P,U,N,X,Y,z,k,G,V,H,W,q,$,J,j,K,Q,Z,ee,te,ne,oe,re;const ie={SIM_RESOLUTION:null!==(o=t.simResolution)&&void 0!==o?o:128,DYE_RESOLUTION:null!==(r=t.dyeResolution)&&void 0!==r?r:1024,DENSITY_DISSIPATION:null!==(i=t.densityDissipation)&&void 0!==i?i:.97,VELOCITY_DISSIPATION:null!==(a=t.velocityDissipation)&&void 0!==a?a:.98,PRESSURE:null!==(l=t.pressure)&&void 0!==l?l:.8,PRESSURE_ITERATIONS:20,CURL:null!==(s=t.curl)&&void 0!==s?s:30,SPLAT_RADIUS:null!==(u=t.splatRadius)&&void 0!==u?u:.25,SPLAT_FORCE:null!==(c=t.splatForce)&&void 0!==c?c:6e3,PROJECTION_DISTANCE:null!==(d=t.projectionDistance)&&void 0!==d?d:1,FADE_SPEED:null!==(f=t.fadeSpeed)&&void 0!==f?f:1,BLOOM:!1!==t.bloom,BLOOM_ITERATIONS:8,BLOOM_RESOLUTION:256,BLOOM_INTENSITY:null!==(m=t.bloomIntensity)&&void 0!==m?m:.8,BLOOM_THRESHOLD:null!==(v=t.bloomThreshold)&&void 0!==v?v:.6,BLOOM_SOFT_KNEE:.7,CALM_DOWN:null!==(h=t.calmDown)&&void 0!==h&&h,CALM_DOWN_DELAY:null!==(g=t.calmDownDelay)&&void 0!==g?g:2e3,CALM_DOWN_STRENGTH:null!==(p=t.calmDownStrength)&&void 0!==p?p:.9},ae={saturation:null!==(x=t.colorSaturation)&&void 0!==x?x:1,brightness:null!==(E=t.colorBrightness)&&void 0!==E?E:.15,saturationBoost:null!==(T=t.saturationBoost)&&void 0!==T?T:1,fixedColor:null!==(R=t.fixedColor)&&void 0!==R?R:"#ff00ff",colorChangeDistance:null!==(y=t.colorChangeDistance)&&void 0!==y?y:0,colorMode:null!==(b=t.colorMode)&&void 0!==b?b:"rainbow",hueMin:null!==(S=t.hueMin)&&void 0!==S?S:0,hueMax:null!==(w=t.hueMax)&&void 0!==w?w:360,gradientSpeed:null!==(M=t.gradientSpeed)&&void 0!==M?M:.5,rainbowMode:!1!==t.rainbowMode,preventOverblending:null!==(D=t.preventOverblending)&&void 0!==D&&D,maxColorIntensity:null!==(F=t.maxColorIntensity)&&void 0!==F?F:1,darkMode:null!==(_=t.darkMode)&&void 0!==_&&_,blendMode:null!==(L=t.blendMode)&&void 0!==L?L:"normal",negativeBloom:null!==(A=t.negativeBloom)&&void 0!==A&&A},le=t.elementInteraction||{},se={enabled:null!==(B=le.enabled)&&void 0!==B&&B,selectors:null!==(C=le.selectors)&&void 0!==C?C:"",trackScroll:null!==(O=le.trackScroll)&&void 0!==O&&O,mode:null!==(I=le.mode)&&void 0!==I?I:"hardCorner",softEdgeRadius:null!==(P=le.softEdgeRadius)&&void 0!==P?P:20,forceFieldStrength:null!==(U=le.forceFieldStrength)&&void 0!==U?U:50,forceFieldRadius:null!==(N=le.forceFieldRadius)&&void 0!==N?N:80,attractFieldStrength:null!==(X=le.attractFieldStrength)&&void 0!==X?X:50,attractFieldRadius:null!==(Y=le.attractFieldRadius)&&void 0!==Y?Y:80,turbulenceIntensity:null!==(z=le.turbulenceIntensity)&&void 0!==z?z:30,turbulenceScale:null!==(k=le.turbulenceScale)&&void 0!==k?k:50,affectNewSplats:!1!==le.affectNewSplats,affectExistingFluid:null!==(G=le.affectExistingFluid)&&void 0!==G&&G,edgeGlow:null!==(V=le.edgeGlow)&&void 0!==V&&V,edgeGlowIntensity:null!==(H=le.edgeGlowIntensity)&&void 0!==H?H:.5,edgeGlowDistance:null!==(W=le.edgeGlowDistance)&&void 0!==W?W:15,edgeGlowMatchFluid:null===(q=le.edgeGlowMatchFluid)||void 0===q||q,edgeGlowColor:null!==($=le.edgeGlowColor)&&void 0!==$?$:"#ffffff"},ue={mode:null!==(J=t.cursorMode)&&void 0!==J?J:"default",dotSize:null!==(j=t.dotCursor?.size)&&void 0!==j?j:10,dotColor:null!==(K=t.dotCursor?.color)&&void 0!==K?K:"#ffffff",crosshairThickness:null!==(Q=t.crosshairCursor?.thickness)&&void 0!==Q?Q:1,crosshairColor:null!==(Z=t.crosshairCursor?.color)&&void 0!==Z?Z:"#ffffff",siblingHoverMode:null!==(ee=t.siblingHoverMode)&&void 0!==ee&&ee},ce=t.scrollAnimations||{},de=null!==(te=ce.enabled)&&void 0!==te&&te,fe=null!==(ne=ce.rules)&&void 0!==ne?ne:[];let me=null!==(oe=t.cssSaturate)&&void 0!==oe?oe:100,ve=null!==(re=t.animationSpeed)&&void 0!==re?re:1;const he={speedMultiplier:ve,interactionForce:1,fadeMultiplier:1,curlMultiplier:1,pressureIterations:ie.PRESSURE_ITERATIONS,frameLimitEnabled:!1,targetFPS:60,paused:!1};let ge=0,pe=[];function xe(){if(se.enabled&&se.selectors)try{const t=document.querySelectorAll(se.selectors);pe=Array.from(t).map(t=>function(t){const n=e.getBoundingClientRect(),o=t.getBoundingClientRect();return{x:(o.left-n.left)/n.width,y:1-(o.bottom-n.top)/n.height,width:o.width/n.width,height:o.height/n.height,px:o.left-n.left,py:o.top-n.top,pWidth:o.width,pHeight:o.height}}(t))}catch(e){console.warn("Invalid element selectors:",e),pe=[]}else pe=[]}let Ee=Math.random(),Te=Date.now();function Re(){let t=[];ae.negativeBloom&&t.push("invert(1)"),t.push(`saturate(${me}%)`),e.style.filter=t.join(" ")}e.style.mixBlendMode=ae.blendMode,Re();class ye{constructor(){this.id=-1,this.texcoordX=0,this.texcoordY=0,this.prevTexcoordX=0,this.prevTexcoordY=0,this.deltaX=0,this.deltaY=0,this.down=!1,this.moved=!1,this.color={r:.5,g:.2,b:.8},this.distanceSinceColorChange=0}}let be=[new ye];function Se(e,t,n,o,r){if(!function(e,t,n,o){const r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,t,4,4,0,n,o,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const a=e.checkFramebufferStatus(e.FRAMEBUFFER);return e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(i),e.deleteTexture(r),a===e.FRAMEBUFFER_COMPLETE}(e,t,n,o)){if(r)switch(t){case e.R16F:return Se(e,e.RG16F,e.RG,o,r);case e.RG16F:return Se(e,e.RGBA16F,e.RGBA,o,r)}return{internalFormat:e.RGBA,format:e.RGBA}}return{internalFormat:t,format:n}}const we=function(e){const t={alpha:!0,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1};let n=e.getContext("webgl2",t);const o=!!n;if(o||(n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)),!n)return console.error("WebGL not supported"),null;let r,i,a,l,s;if(o)n.getExtension("EXT_color_buffer_float"),i=n.getExtension("OES_texture_float_linear"),r=n.HALF_FLOAT;else{const e=n.getExtension("OES_texture_half_float");r=e?e.HALF_FLOAT_OES:n.UNSIGNED_BYTE,i=n.getExtension("OES_texture_half_float_linear")}return n.clearColor(0,0,0,1),o?(a=Se(n,n.RGBA16F,n.RGBA,r,o),l=Se(n,n.RG16F,n.RG,r,o),s=Se(n,n.R16F,n.RED,r,o)):(a={internalFormat:n.RGBA,format:n.RGBA},l={internalFormat:n.RGBA,format:n.RGBA},s={internalFormat:n.RGBA,format:n.RGBA}),{gl:n,ext:{formatRGBA:a,formatRG:l,formatR:s,halfFloatTexType:r,supportLinearFiltering:!!i},isWebGL2:o}}(e);if(!we)return;const{gl:Me,ext:De,isWebGL2:Fe}=we;function _e(e,t){const n=Me.createShader(e);return Me.shaderSource(n,t),Me.compileShader(n),Me.getShaderParameter(n,Me.COMPILE_STATUS)?n:(console.error("Shader error:",Me.getShaderInfoLog(n)),Me.deleteShader(n),null)}function Le(e,t){const n=_e(Me.VERTEX_SHADER,e),o=_e(Me.FRAGMENT_SHADER,t);if(!n||!o)return null;const r=Me.createProgram();if(Me.attachShader(r,n),Me.attachShader(r,o),Me.linkProgram(r),!Me.getProgramParameter(r,Me.LINK_STATUS))return console.error("Program error:",Me.getProgramInfoLog(r)),null;const i={},a=Me.getProgramParameter(r,Me.ACTIVE_UNIFORMS);for(let e=0;e<a;e++){const t=Me.getActiveUniform(r,e).name;i[t]=Me.getUniformLocation(r,t)}return{program:r,uniforms:i}}const Ae="\n        precision highp float;\n        attribute vec2 aPosition;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform vec2 texelSize;\n        \n        void main () {\n            vUv = aPosition * 0.5 + 0.5;\n            vL = vUv - vec2(texelSize.x, 0.0);\n            vR = vUv + vec2(texelSize.x, 0.0);\n            vT = vUv + vec2(0.0, texelSize.y);\n            vB = vUv - vec2(0.0, texelSize.y);\n            gl_Position = vec4(aPosition, 0.0, 1.0);\n        }\n    ",Be="\n        precision highp float;\n        attribute vec2 aPosition;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        uniform vec2 texelSize;\n        \n        void main () {\n            vUv = aPosition * 0.5 + 0.5;\n            float offset = 1.33333333;\n            vL = vUv - texelSize * offset;\n            vR = vUv + texelSize * offset;\n            gl_Position = vec4(aPosition, 0.0, 1.0);\n        }\n    ",Ce={copy:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        \n        void main () {\n            gl_FragColor = texture2D(uTexture, vUv);\n        }\n    "),clear:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float value;\n        \n        void main () {\n            gl_FragColor = value * texture2D(uTexture, vUv);\n        }\n    "),display:Le(Ae,"\n        precision highp float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform sampler2D uBloom;\n        uniform bool useBloom;\n        \n        void main () {\n            vec3 c = texture2D(uTexture, vUv).rgb;\n            if (useBloom) {\n                vec3 bloom = texture2D(uBloom, vUv).rgb;\n                c += bloom;\n            }\n            float a = max(c.r, max(c.g, c.b));\n            gl_FragColor = vec4(c, a);\n        }\n    "),bloomPrefilter:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec3 curve;\n        uniform float threshold;\n        \n        void main () {\n            vec3 c = texture2D(uTexture, vUv).rgb;\n            float br = max(c.r, max(c.g, c.b));\n            float rq = clamp(br - curve.x, 0.0, curve.y);\n            rq = curve.z * rq * rq;\n            c *= max(rq, br - threshold) / max(br, 0.0001);\n            gl_FragColor = vec4(c, 0.0);\n        }\n    "),bloomBlur:Le(Be,"\n        precision mediump float;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        \n        void main () {\n            vec4 sum = vec4(0.0);\n            sum += texture2D(uTexture, vL);\n            sum += texture2D(uTexture, vR);\n            sum *= 0.5;\n            gl_FragColor = sum;\n        }\n    "),bloomFinal:Le(Be,"\n        precision mediump float;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform float intensity;\n        \n        void main () {\n            vec4 sum = vec4(0.0);\n            sum += texture2D(uTexture, vL);\n            sum += texture2D(uTexture, vR);\n            sum *= 0.5 * intensity;\n            gl_FragColor = sum;\n        }\n    "),splat:Le(Ae,"\n        precision highp float;\n        varying vec2 vUv;\n        uniform sampler2D uTarget;\n        uniform float aspectRatio;\n        uniform vec3 color;\n        uniform vec2 point;\n        uniform float radius;\n        \n        void main () {\n            vec2 p = vUv - point.xy;\n            p.x *= aspectRatio;\n            vec3 splat = exp(-dot(p, p) / radius) * color;\n            vec3 base = texture2D(uTarget, vUv).xyz;\n            gl_FragColor = vec4(base + splat, 1.0);\n        }\n    "),advection:Le(Ae,"\n        precision highp float;\n        varying vec2 vUv;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uSource;\n        uniform vec2 texelSize;\n        uniform vec2 dyeTexelSize;\n        uniform float dt;\n        uniform float dissipation;\n        \n        void main () {\n            vec2 coord = vUv - dt * texture2D(uVelocity, vUv).xy * texelSize;\n            vec4 result = texture2D(uSource, coord);\n            float decay = 1.0 + dissipation * dt;\n            gl_FragColor = result / decay;\n        }\n    "),divergence:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        \n        void main () {\n            float L = texture2D(uVelocity, vL).x;\n            float R = texture2D(uVelocity, vR).x;\n            float T = texture2D(uVelocity, vT).y;\n            float B = texture2D(uVelocity, vB).y;\n            vec2 C = texture2D(uVelocity, vUv).xy;\n            if (vL.x < 0.0) { L = -C.x; }\n            if (vR.x > 1.0) { R = -C.x; }\n            if (vT.y > 1.0) { T = -C.y; }\n            if (vB.y < 0.0) { B = -C.y; }\n            float div = 0.5 * (R - L + T - B);\n            gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\n        }\n    "),curl:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        \n        void main () {\n            float L = texture2D(uVelocity, vL).y;\n            float R = texture2D(uVelocity, vR).y;\n            float T = texture2D(uVelocity, vT).x;\n            float B = texture2D(uVelocity, vB).x;\n            float vorticity = R - L - T + B;\n            gl_FragColor = vec4(0.5 * vorticity, 0.0, 0.0, 1.0);\n        }\n    "),vorticity:Le(Ae,"\n        precision highp float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uVelocity;\n        uniform sampler2D uCurl;\n        uniform float curl;\n        uniform float dt;\n        \n        void main () {\n            float L = texture2D(uCurl, vL).x;\n            float R = texture2D(uCurl, vR).x;\n            float T = texture2D(uCurl, vT).x;\n            float B = texture2D(uCurl, vB).x;\n            float C = texture2D(uCurl, vUv).x;\n            vec2 force = 0.5 * vec2(abs(T) - abs(B), abs(R) - abs(L));\n            force /= length(force) + 0.0001;\n            force *= curl * C;\n            force.y *= -1.0;\n            vec2 vel = texture2D(uVelocity, vUv).xy;\n            gl_FragColor = vec4(vel + force * dt, 0.0, 1.0);\n        }\n    "),pressure:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uPressure;\n        uniform sampler2D uDivergence;\n        \n        void main () {\n            float L = texture2D(uPressure, vL).x;\n            float R = texture2D(uPressure, vR).x;\n            float T = texture2D(uPressure, vT).x;\n            float B = texture2D(uPressure, vB).x;\n            float C = texture2D(uPressure, vUv).x;\n            float divergence = texture2D(uDivergence, vUv).x;\n            float pressure = (L + R + B + T - divergence) * 0.25;\n            gl_FragColor = vec4(pressure, 0.0, 0.0, 1.0);\n        }\n    "),gradientSubtract:Le(Ae,"\n        precision mediump float;\n        varying vec2 vUv;\n        varying vec2 vL;\n        varying vec2 vR;\n        varying vec2 vT;\n        varying vec2 vB;\n        uniform sampler2D uPressure;\n        uniform sampler2D uVelocity;\n        \n        void main () {\n            float L = texture2D(uPressure, vL).x;\n            float R = texture2D(uPressure, vR).x;\n            float T = texture2D(uPressure, vT).x;\n            float B = texture2D(uPressure, vB).x;\n            vec2 velocity = texture2D(uVelocity, vUv).xy;\n            velocity.xy -= vec2(R - L, T - B);\n            gl_FragColor = vec4(velocity, 0.0, 1.0);\n        }\n    ")},Oe=Me.createBuffer();Me.bindBuffer(Me.ARRAY_BUFFER,Oe),Me.bufferData(Me.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),Me.STATIC_DRAW);const Ie=Me.createBuffer();function Pe(e,t=!1){null==e?(Me.viewport(0,0,Me.drawingBufferWidth,Me.drawingBufferHeight),Me.bindFramebuffer(Me.FRAMEBUFFER,null)):(Me.viewport(0,0,e.width,e.height),Me.bindFramebuffer(Me.FRAMEBUFFER,e.fbo)),t&&(Me.clearColor(0,0,0,1),Me.clear(Me.COLOR_BUFFER_BIT)),Me.bindBuffer(Me.ARRAY_BUFFER,Oe),Me.bindBuffer(Me.ELEMENT_ARRAY_BUFFER,Ie),Me.enableVertexAttribArray(0),Me.vertexAttribPointer(0,2,Me.FLOAT,!1,0,0),Me.drawElements(Me.TRIANGLES,6,Me.UNSIGNED_SHORT,0)}let Ue,Ne,Xe,Ye,ze,ke;Me.bindBuffer(Me.ELEMENT_ARRAY_BUFFER,Ie),Me.bufferData(Me.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),Me.STATIC_DRAW);let Ge=[];function Ve(e){let t=Me.drawingBufferWidth/Me.drawingBufferHeight;t<1&&(t=1/t);const n=Math.round(e),o=Math.round(e*t);return Me.drawingBufferWidth>Me.drawingBufferHeight?{width:o,height:n}:{width:n,height:o}}function He(e,t,n,o,r,i){Me.activeTexture(Me.TEXTURE0);const a=Me.createTexture();Me.bindTexture(Me.TEXTURE_2D,a),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MIN_FILTER,i),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_MAG_FILTER,i),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_WRAP_S,Me.CLAMP_TO_EDGE),Me.texParameteri(Me.TEXTURE_2D,Me.TEXTURE_WRAP_T,Me.CLAMP_TO_EDGE),Me.texImage2D(Me.TEXTURE_2D,0,n,e,t,0,o,r,null);const l=Me.createFramebuffer();return Me.bindFramebuffer(Me.FRAMEBUFFER,l),Me.framebufferTexture2D(Me.FRAMEBUFFER,Me.COLOR_ATTACHMENT0,Me.TEXTURE_2D,a,0),Me.viewport(0,0,e,t),Me.clear(Me.COLOR_BUFFER_BIT),{texture:a,fbo:l,width:e,height:t,texelSizeX:1/e,texelSizeY:1/t,attach:e=>(Me.activeTexture(Me.TEXTURE0+e),Me.bindTexture(Me.TEXTURE_2D,a),e)}}function We(e,t,n,o,r,i){let a=He(e,t,n,o,r,i),l=He(e,t,n,o,r,i);return{width:e,height:t,texelSizeX:a.texelSizeX,texelSizeY:a.texelSizeY,get read(){return a},set read(e){a=e},get write(){return l},set write(e){l=e},swap(){const e=a;a=l,l=e}}}const qe=e.closest(".fgb-fluid-group");let $e,Je=0,je=0;function Ke(){const t=qe.offsetWidth||300,n=qe.offsetHeight||200;if(Math.abs(t-Je)>1||Math.abs(n-je)>1){const o=4096,r=Math.min(Math.max(t,100),o),i=Math.min(Math.max(n,100),o);return e.width=r,e.height=i,Je=t,je=n,!0}return!1}if(window.addEventListener("resize",function(){clearTimeout($e),$e=setTimeout(function(){Ke()&&tt(),xe()},100)}),se.enabled&&se.trackScroll&&window.addEventListener("scroll",function(){xe()},{passive:!0}),se.enabled&&setTimeout(xe,200),de&&fe.length>0){function Qe(e,t,n,o,r){return e<=t?o:e>=n?r:o+(e-t)/(n-t)*(r-o)}function Ze(e,t){switch(e){case"colorSaturation":ae.saturation=t;break;case"colorBrightness":ae.brightness=t;break;case"fadeSpeed":ie.FADE_SPEED=t;break;case"curl":ie.CURL=t;break;case"splatRadius":ie.SPLAT_RADIUS=t;break;case"splatForce":ie.SPLAT_FORCE=t;break;case"projectionDistance":ie.PROJECTION_DISTANCE=t;break;case"cssSaturate":me=t,Re();break;case"animationSpeed":ve=t,he.speedMultiplier=t;break;case"densityDissipation":ie.DENSITY_DISSIPATION=t}}function et(){const e=window.scrollY||window.pageYOffset;for(const t of fe){const n=Qe(e,t.scrollStart,t.scrollEnd,t.valueStart,t.valueEnd);Ze(t.property,n)}}et(),window.addEventListener("scroll",et,{passive:!0})}function tt(){const e=Ve(ie.SIM_RESOLUTION),t=Ve(ie.DYE_RESOLUTION),n=De.halfFloatTexType,o=De.formatRGBA,r=De.formatRG,i=De.formatR,a=De.supportLinearFiltering?Me.LINEAR:Me.NEAREST;Ue=We(t.width,t.height,o.internalFormat,o.format,n,a),Ne=We(e.width,e.height,r.internalFormat,r.format,n,a),Xe=He(e.width,e.height,i.internalFormat,i.format,n,Me.NEAREST),Ye=He(e.width,e.height,i.internalFormat,i.format,n,Me.NEAREST),ze=We(e.width,e.height,i.internalFormat,i.format,n,Me.NEAREST),function(){const e=Ve(ie.BLOOM_RESOLUTION),t=De.halfFloatTexType,n=De.formatRGBA,o=De.supportLinearFiltering?Me.LINEAR:Me.NEAREST;ke=He(e.width,e.height,n.internalFormat,n.format,t,o),Ge.length=0;for(let r=0;r<ie.BLOOM_ITERATIONS;r++){const i=e.width>>r+1,a=e.height>>r+1;if(i<2||a<2)break;const l=He(i,a,n.internalFormat,n.format,t,o);Ge.push(l)}}()}function nt(){let e;const t=Math.min(ae.saturation*ae.saturationBoost,1);switch(ae.colorMode||"rainbow"){case"rainbow":e=ot(Math.random(),t,1);break;case"huerange":const n=ae.hueMin/360,o=ae.hueMax/360;let r;if(n<=o)r=n+Math.random()*(o-n);else{const e=1-n+o;r=n+Math.random()*e,r>1&&(r-=1)}e=ot(r,t,1);break;case"gradient":Ee+=.01*ae.gradientSpeed,Ee>1&&(Ee-=1),e=ot(Ee,t,1);break;default:e=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:{r:1,g:0,b:1}}(ae.fixedColor||"#ff00ff")}if(e.r*=ae.brightness,e.g*=ae.brightness,e.b*=ae.brightness,ae.preventOverblending){const t=ae.maxColorIntensity;e.r=Math.min(e.r,t),e.g=Math.min(e.g,t),e.b=Math.min(e.b,t)}return ae.darkMode&&(e.r=-e.r,e.g=-e.g,e.b=-e.b),e}function ot(e,t,n){let o,r,i;const a=Math.floor(6*e),l=6*e-a,s=n*(1-t),u=n*(1-l*t),c=n*(1-(1-l)*t);switch(a%6){case 0:o=n,r=c,i=s;break;case 1:o=u,r=n,i=s;break;case 2:o=s,r=n,i=c;break;case 3:o=s,r=u,i=n;break;case 4:o=c,r=s,i=n;break;case 5:o=n,r=s,i=u}return{r:o,g:r,b:i}}Ke(),tt();let rt=Date.now();function it(t,n,o,r,i){Te=Date.now(),Me.useProgram(Ce.splat.program),Me.uniform1i(Ce.splat.uniforms.uTarget,Ne.read.attach(0)),Me.uniform1f(Ce.splat.uniforms.aspectRatio,e.width/e.height),Me.uniform2f(Ce.splat.uniforms.point,t,n),Me.uniform3f(Ce.splat.uniforms.color,o,r,0),Me.uniform1f(Ce.splat.uniforms.radius,function(t){const n=e.width/e.height;return n>1&&(t*=n),t}(ie.SPLAT_RADIUS/100)),Pe(Ne.write),Ne.swap(),Me.uniform1i(Ce.splat.uniforms.uTarget,Ue.read.attach(0)),Me.uniform3f(Ce.splat.uniforms.color,i.r,i.g,i.b),Pe(Ue.write),Ue.swap()}ue.siblingHoverMode?(document.addEventListener("mousemove",t=>{const n=e.getBoundingClientRect();t.clientX>=n.left&&t.clientX<=n.right&&t.clientY>=n.top&&t.clientY<=n.bottom&&dt(be[0],t.clientX-n.left,t.clientY-n.top)}),document.addEventListener("mousedown",t=>{const n=e.getBoundingClientRect();if(t.clientX>=n.left&&t.clientX<=n.right&&t.clientY>=n.top&&t.clientY<=n.bottom){const e=be[0];e.down=!0,e.color=nt()}}),document.addEventListener("mouseup",()=>{be[0].down=!1})):(qe.addEventListener("mousemove",t=>{const n=be[0],o=e.getBoundingClientRect();dt(n,t.clientX-o.left,t.clientY-o.top)}),qe.addEventListener("mousedown",()=>{const e=be[0];e.down=!0,e.color=nt()}),qe.addEventListener("mouseup",()=>{be[0].down=!1}));let at=null,lt=null,st=null;function ut(e,t,n){const o=ue.mode;"dot"===o&&at?n?(at.style.display="block",at.style.left=e+"px",at.style.top=t+"px"):at.style.display="none":"crosshair"===o&&lt&&st&&(n?(lt.style.display="block",st.style.display="block",lt.style.top=t+"px",st.style.left=e+"px"):(lt.style.display="none",st.style.display="none"))}function ct(t,n,o,r){t.id=n,t.down=!0,t.moved=!1,t.texcoordX=o/e.width,t.texcoordY=1-r/e.height,t.prevTexcoordX=t.texcoordX,t.prevTexcoordY=t.texcoordY,t.deltaX=0,t.deltaY=0,t.color=nt()}function dt(t,n,o){if(t.prevTexcoordX=t.texcoordX,t.prevTexcoordY=t.texcoordY,t.texcoordX=n/e.width,t.texcoordY=1-o/e.height,t.deltaX=function(t){const n=e.width/e.height;return n<1&&(t*=n),t}(t.texcoordX-t.prevTexcoordX),t.deltaY=function(t){const n=e.width/e.height;return(n>1||n<1)&&(t/=n),t}(t.texcoordY-t.prevTexcoordY),t.moved=Math.abs(t.deltaX)>0||Math.abs(t.deltaY)>0,t.moved){const n=t.deltaX*e.width,o=t.deltaY*e.height,r=Math.sqrt(n*n+o*o);t.distanceSinceColorChange+=r;const i=ae.colorChangeDistance;(0===i||t.distanceSinceColorChange>=i)&&(t.color=nt(),t.distanceSinceColorChange=0)}}"default"!==ue.mode&&(function(){const e=ue.mode;"hidden"===e?qe.style.cursor="none":"dot"===e?(qe.style.cursor="none",at=document.createElement("div"),at.className="fgb-dot-cursor",at.style.cssText=`\n                position: fixed;\n                pointer-events: none;\n                z-index: 999999;\n                width: ${ue.dotSize}px;\n                height: ${ue.dotSize}px;\n                background-color: ${ue.dotColor};\n                border-radius: 50%;\n                transform: translate(-50%, -50%);\n                display: none;\n            `,document.body.appendChild(at)):"crosshair"===e&&(qe.style.cursor="none",lt=document.createElement("div"),lt.className="fgb-crosshair-h",lt.style.cssText=`\n                position: fixed;\n                left: 0;\n                right: 0;\n                height: ${ue.crosshairThickness}px;\n                background-color: ${ue.crosshairColor};\n                pointer-events: none;\n                z-index: 999999;\n                display: none;\n            `,document.body.appendChild(lt),st=document.createElement("div"),st.className="fgb-crosshair-v",st.style.cssText=`\n                position: fixed;\n                top: 0;\n                bottom: 0;\n                width: ${ue.crosshairThickness}px;\n                background-color: ${ue.crosshairColor};\n                pointer-events: none;\n                z-index: 999999;\n                display: none;\n            `,document.body.appendChild(st))}(),qe.addEventListener("mouseenter",()=>{"dot"===ue.mode&&at?at.style.display="block":"crosshair"===ue.mode&&(lt&&(lt.style.display="block"),st&&(st.style.display="block"))}),qe.addEventListener("mouseleave",()=>{ut(0,0,!1)}),window.addEventListener("mousemove",e=>{const t=qe.getBoundingClientRect(),n=e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom;ut(e.clientX,e.clientY,n)})),document.addEventListener("touchstart",t=>{const n=t.touches;for(;n.length>=be.length;)be.push(new ye);for(let t=0;t<n.length;t++){const o=e.getBoundingClientRect(),r=(n[t].clientX-o.left)*(e.width/o.width),i=(n[t].clientY-o.top)*(e.height/o.height);ct(be[t+1],n[t].identifier,r,i)}},{passive:!0}),document.addEventListener("touchmove",t=>{const n=t.touches;for(let t=0;t<n.length;t++){const o=be[t+1];if(!o||!o.down)continue;const r=e.getBoundingClientRect();dt(o,(n[t].clientX-r.left)*(e.width/r.width),(n[t].clientY-r.top)*(e.height/r.height))}},{passive:!0}),document.addEventListener("touchend",e=>{const t=e.changedTouches;for(let e=0;e<t.length;e++){const n=be.find(n=>n.id===t[e].identifier);n&&(n.down=!1)}},{passive:!0}),n&&0!==n.length?n.forEach(t=>{const n=e=>!e||e.length<2?0:e[0]+Math.random()*(e[1]-e[0]),o=t.timing?.delay||0,r=t.timing?.duration||500,i=t.timing?.repeat||0,a=t.timing?.repeatDelay||0,l=!1!==t.randomizeColor?null:nt(),s=()=>{const o=(t.x+n(t.random?.x))/100,i=1-(t.y+n(t.random?.y))/100,a=n(t.random?.angle)*(Math.PI/180),s=n(t.random?.speed),u=(t.props?.speed||1)+s,c=1+n(t.random?.size)/100,d=n(t.random?.force),f=(t.force||1)+d,m=function(t,n,o,r,i=1){const a=[],l=t.props||{},s=i||1;switch(t.type){case"stroke":{const t=(l.length||100)*s/e.width,i=(l.angle||0)*Math.PI/180+r,u=30;for(let e=0;e<=u;e++){const r=e/u;a.push({x:n+(r-.5)*t*Math.cos(i),y:o+(r-.5)*t*Math.sin(i)})}break}case"circle":{const t=(l.radius||50)*s/e.width,i=36;for(let e=0;e<=i;e++){const l=e/i*Math.PI*2+r;a.push({x:n+Math.cos(l)*t,y:o+Math.sin(l)*t})}break}case"ellipse":{const t=(l.radiusX||60)*s/e.width,i=(l.radiusY||40)*s/e.height,u=(l.rotation||0)*Math.PI/180+r,c=36;for(let e=0;e<=c;e++){const r=e/c*Math.PI*2,l=Math.cos(r)*t,s=Math.sin(r)*i;a.push({x:n+l*Math.cos(u)-s*Math.sin(u),y:o+l*Math.sin(u)+s*Math.cos(u)})}break}case"rectangle":{const t=(l.width||80)*s/e.width,i=(l.height||50)*s/e.height,u=(l.rotation||0)*Math.PI/180+r,c=[[-t/2,-i/2],[t/2,-i/2],[t/2,i/2],[-t/2,i/2],[-t/2,-i/2]],d=8;for(let e=0;e<4;e++)for(let t=0;t<=d;t++){const r=t/d,i=c[e][0]+r*(c[e+1][0]-c[e][0]),l=c[e][1]+r*(c[e+1][1]-c[e][1]);a.push({x:n+i*Math.cos(u)-l*Math.sin(u),y:o+i*Math.sin(u)+l*Math.cos(u)})}break}case"svg":case"path":{const e=l.pathData||l.points||"",t=(l.rotation||0)*Math.PI/180+r,i=l.scale||1;let s=[],u=!1;if(Array.isArray(e))s=e,u=!0;else if("string"==typeof e){const t=e.match(/[-\d.]+/g);if(t)for(let e=0;e<t.length-1;e+=2)s.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])})}if(u&&s.length>0){const e=s.reduce((e,t)=>e+t.x,0)/s.length,n=s.reduce((e,t)=>e+t.y,0)/s.length;for(const o of s){const r=(e+(o.x-e)*i)/100-.5,l=1-(n+(o.y-n)*i)/100-.5;a.push({x:.5+r*Math.cos(t)-l*Math.sin(t),y:.5+r*Math.sin(t)+l*Math.cos(t)})}}else for(const e of s){const r=.002*i,l=e.x*r,s=e.y*r;a.push({x:n+l*Math.cos(t)-s*Math.sin(t),y:o+l*Math.sin(t)+s*Math.cos(t)})}break}}return a}(t,o,i,a,c);let v;v="fixed"===t.colorMode&&t.color?(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null})(t.color)||nt():l||nt(),function(e,t,n,o,r,i){if(e.length<2)return;const a=performance.now(),l=400*n*(r||1);let s=e[0].x,u=e[0].y;const c=i||0;requestAnimationFrame(function n(r){const i=r-a,d=Math.min(i/t,1),f=d*(e.length-1),m=Math.floor(f),v=f-m,h=e[Math.min(m,e.length-1)],g=e[Math.min(m+1,e.length-1)],p=v*v*(3-2*v),x=h.x+p*(g.x-h.x),E=h.y+p*(g.y-h.y),T=(x-s)*l,R=(E-u)*l;let y=o;if(c>0){const e=d*c;y={r:(o.r+.5*e)%1,g:(o.g+.3*e)%1,b:(o.b+.7*e)%1}}(Math.abs(T)>.01||Math.abs(R)>.01)&&it(x,E,T,R,y),s=x,u=E,d<1&&requestAnimationFrame(n)})}(m,r,u,v,f,t.colorSpeed)},u=e=>{setTimeout(s,o+e*(r+a))};u(0);for(let e=1;e<=i;e++)u(e)}):function(e){for(let t=0;t<e;t++){const e=nt();e.r*=10,e.g*=10,e.b*=10,it(Math.random(),Math.random(),1e3*(Math.random()-.5),1e3*(Math.random()-.5),e)}}(parseInt(5*Math.random())+5),function t(n){if(he.paused)return void requestAnimationFrame(t);if(he.frameLimitEnabled){const e=1e3/he.targetFPS;if(n-ge<e)return void requestAnimationFrame(t);ge=n}const o=function(){const e=Date.now();let t=(e-rt)/1e3;return t=Math.min(t,.016666),rt=e,t*he.speedMultiplier}();var r;be.forEach(t=>{t.moved&&(t.moved=!1,function(t){let n=t.deltaX*ie.SPLAT_FORCE*ie.PROJECTION_DISTANCE*he.interactionForce,o=t.deltaY*ie.SPLAT_FORCE*ie.PROJECTION_DISTANCE*he.interactionForce,r=t.color;if(se.enabled&&se.affectNewSplats){const i=function(t,n){if(!se.enabled||0===pe.length)return{blocked:!1,forceX:0,forceY:0,opacity:1};const o=se.mode;let r={blocked:!1,forceX:0,forceY:0,opacity:1};for(const i of pe){const a=t>=i.x&&t<=i.x+i.width,l=n>=i.y&&n<=i.y+i.height,s=a&&l,u=i.x+i.width/2,c=i.y+i.height/2,d=(e.width,e.height,(t-u)*e.width),f=(n-c)*e.height,m=Math.sqrt(d*d+f*f),v=i.pWidth/2,h=i.pHeight/2,g=s?0:Math.max(0,Math.min(Math.abs((t-u)*e.width)-v,Math.abs((n-c)*e.height)-h));switch(o){case"hardCorner":s&&(r.blocked=!0,r.opacity=0);break;case"softEdge":const e=se.softEdgeRadius;s?(r.blocked=!0,r.opacity=0):g<e&&(r.opacity=Math.min(r.opacity,g/e));break;case"forceField":const t=se.forceFieldRadius;if(m<t+v){const e=(1-m/(t+v))*se.forceFieldStrength,n=Math.atan2(f,d);r.forceX+=Math.cos(n)*e,r.forceY+=Math.sin(n)*e}s&&(r.blocked=!0);break;case"attractField":const n=se.attractFieldRadius;if(m<n+v&&!s){const e=(1-m/(n+v))*se.attractFieldStrength,t=Math.atan2(f,d);r.forceX-=Math.cos(t)*e,r.forceY-=Math.sin(t)*e}break;case"turbulence":const o=i.pWidth,a=se.turbulenceIntensity,l=se.turbulenceScale;if(m<2*o&&!s){const e=Math.atan2(f,d)+Math.PI/2,t=(1-m/(2*o))*a;r.forceX+=Math.cos(e)*t*(.5*Math.sin(Date.now()/l)+.5),r.forceY+=Math.sin(e)*t*(.5*Math.cos(Date.now()/l)+.5)}}}return r}(t.texcoordX,t.texcoordY);if(i.blocked)return;n+=i.forceX,o+=i.forceY,r={r:t.color.r*i.opacity,g:t.color.g*i.opacity,b:t.color.b*i.opacity}}it(t.texcoordX,t.texcoordY,n,o,r)}(t))}),function(t){Me.disable(Me.BLEND),Me.useProgram(Ce.curl.program),Me.uniform2f(Ce.curl.uniforms.texelSize,Ne.texelSizeX,Ne.texelSizeY),Me.uniform1i(Ce.curl.uniforms.uVelocity,Ne.read.attach(0)),Pe(Ye),Me.useProgram(Ce.vorticity.program),Me.uniform2f(Ce.vorticity.uniforms.texelSize,Ne.texelSizeX,Ne.texelSizeY),Me.uniform1i(Ce.vorticity.uniforms.uVelocity,Ne.read.attach(0)),Me.uniform1i(Ce.vorticity.uniforms.uCurl,Ye.attach(1)),Me.uniform1f(Ce.vorticity.uniforms.curl,ie.CURL*he.curlMultiplier),Me.uniform1f(Ce.vorticity.uniforms.dt,t),Pe(Ne.write),Ne.swap(),Me.useProgram(Ce.divergence.program),Me.uniform2f(Ce.divergence.uniforms.texelSize,Ne.texelSizeX,Ne.texelSizeY),Me.uniform1i(Ce.divergence.uniforms.uVelocity,Ne.read.attach(0)),Pe(Xe),Me.useProgram(Ce.clear.program),Me.uniform1i(Ce.clear.uniforms.uTexture,ze.read.attach(0)),Me.uniform1f(Ce.clear.uniforms.value,ie.PRESSURE),Pe(ze.write),ze.swap(),Me.useProgram(Ce.pressure.program),Me.uniform2f(Ce.pressure.uniforms.texelSize,Ne.texelSizeX,Ne.texelSizeY),Me.uniform1i(Ce.pressure.uniforms.uDivergence,Xe.attach(0));for(let e=0;e<he.pressureIterations;e++)Me.uniform1i(Ce.pressure.uniforms.uPressure,ze.read.attach(1)),Pe(ze.write),ze.swap();Me.useProgram(Ce.gradientSubtract.program),Me.uniform2f(Ce.gradientSubtract.uniforms.texelSize,Ne.texelSizeX,Ne.texelSizeY),Me.uniform1i(Ce.gradientSubtract.uniforms.uPressure,ze.read.attach(0)),Me.uniform1i(Ce.gradientSubtract.uniforms.uVelocity,Ne.read.attach(1)),Pe(Ne.write),Ne.swap(),Me.useProgram(Ce.advection.program),Me.uniform2f(Ce.advection.uniforms.texelSize,Ne.texelSizeX,Ne.texelSizeY),Me.uniform2f(Ce.advection.uniforms.dyeTexelSize,Ne.texelSizeX,Ne.texelSizeY);const n=Ne.read.attach(0);Me.uniform1i(Ce.advection.uniforms.uVelocity,n),Me.uniform1i(Ce.advection.uniforms.uSource,n),Me.uniform1f(Ce.advection.uniforms.dt,t);let o=ie.VELOCITY_DISSIPATION;if(ie.CALM_DOWN){const e=Date.now()-Te;if(e>ie.CALM_DOWN_DELAY){const t=Math.min((e-ie.CALM_DOWN_DELAY)/1e3,1);o=ie.VELOCITY_DISSIPATION*(1-t)+ie.CALM_DOWN_STRENGTH*t}}Me.uniform1f(Ce.advection.uniforms.dissipation,o),Pe(Ne.write),Ne.swap(),Me.uniform2f(Ce.advection.uniforms.dyeTexelSize,Ue.texelSizeX,Ue.texelSizeY),Me.uniform1i(Ce.advection.uniforms.uVelocity,Ne.read.attach(0)),Me.uniform1i(Ce.advection.uniforms.uSource,Ue.read.attach(1));const r=ie.DENSITY_DISSIPATION/ie.FADE_SPEED*he.fadeMultiplier;Me.uniform1f(Ce.advection.uniforms.dissipation,r),Pe(Ue.write),Ue.swap(),se.enabled&&se.affectExistingFluid&&pe.length>0&&function(){const t=se.mode;for(const n of pe){const o=n.x+n.width/2,r=n.y+n.height/2;switch(t){case"hardCorner":case"softEdge":const i="softEdge"===t?.5*Math.max(n.width,n.height)+se.softEdgeRadius/e.width:.4*Math.max(n.width,n.height);Me.useProgram(Ce.splat.program),Me.uniform1i(Ce.splat.uniforms.uTarget,Ne.read.attach(0)),Me.uniform1f(Ce.splat.uniforms.aspectRatio,e.width/e.height),Me.uniform2f(Ce.splat.uniforms.point,o,r),Me.uniform3f(Ce.splat.uniforms.color,0,0,0),Me.uniform1f(Ce.splat.uniforms.radius,.5*i),Pe(Ne.write),Ne.swap(),Me.uniform1i(Ce.splat.uniforms.uTarget,Ue.read.attach(0));const a="softEdge"===t?-.02:-.05;Me.uniform3f(Ce.splat.uniforms.color,a,a,a),Me.uniform1f(Ce.splat.uniforms.radius,.5*i),Pe(Ue.write),Ue.swap();break;case"forceField":const l=se.forceFieldRadius/e.width+.5*n.width,s=.01*se.forceFieldStrength;Me.useProgram(Ce.splat.program),Me.uniform1i(Ce.splat.uniforms.uTarget,Ne.read.attach(0)),Me.uniform1f(Ce.splat.uniforms.aspectRatio,e.width/e.height),Me.uniform2f(Ce.splat.uniforms.point,o,r),Me.uniform3f(Ce.splat.uniforms.color,s,s,0),Me.uniform1f(Ce.splat.uniforms.radius,l),Pe(Ne.write),Ne.swap();break;case"attractField":const u=se.attractFieldRadius/e.width+.5*n.width,c=.005*-se.attractFieldStrength;Me.useProgram(Ce.splat.program),Me.uniform1i(Ce.splat.uniforms.uTarget,Ne.read.attach(0)),Me.uniform1f(Ce.splat.uniforms.aspectRatio,e.width/e.height),Me.uniform2f(Ce.splat.uniforms.point,o,r),Me.uniform3f(Ce.splat.uniforms.color,c,c,0),Me.uniform1f(Ce.splat.uniforms.radius,u),Pe(Ne.write),Ne.swap();break;case"turbulence":const d=n.width+se.turbulenceIntensity/e.width,f=.001*se.turbulenceIntensity,m=Date.now()/se.turbulenceScale,v=Math.sin(m)*f;Me.useProgram(Ce.splat.program),Me.uniform1i(Ce.splat.uniforms.uTarget,Ne.read.attach(0)),Me.uniform1f(Ce.splat.uniforms.aspectRatio,e.width/e.height),Me.uniform2f(Ce.splat.uniforms.point,o,r),Me.uniform3f(Ce.splat.uniforms.color,v,.5*-v,0),Me.uniform1f(Ce.splat.uniforms.radius,d),Pe(Ne.write),Ne.swap()}}}()}(o),r=null,ie.BLOOM&&Ge.length>=2&&function(e,t){if(Ge.length<2)return;let n=t;Me.disable(Me.BLEND),Me.useProgram(Ce.bloomPrefilter.program);const o=ie.BLOOM_THRESHOLD*ie.BLOOM_SOFT_KNEE+1e-4,r=ie.BLOOM_THRESHOLD-o,i=2*o,a=.25/o;Me.uniform3f(Ce.bloomPrefilter.uniforms.curve,r,i,a),Me.uniform1f(Ce.bloomPrefilter.uniforms.threshold,ie.BLOOM_THRESHOLD),Me.uniform1i(Ce.bloomPrefilter.uniforms.uTexture,e.attach(0)),Pe(n),Me.useProgram(Ce.bloomBlur.program);for(let e=0;e<Ge.length;e++){const t=Ge[e];Me.uniform2f(Ce.bloomBlur.uniforms.texelSize,n.texelSizeX,n.texelSizeY),Me.uniform1i(Ce.bloomBlur.uniforms.uTexture,n.attach(0)),Pe(t),n=t}Me.blendFunc(Me.ONE,Me.ONE),Me.enable(Me.BLEND);for(let e=Ge.length-2;e>=0;e--){const t=Ge[e];Me.uniform2f(Ce.bloomBlur.uniforms.texelSize,n.texelSizeX,n.texelSizeY),Me.uniform1i(Ce.bloomBlur.uniforms.uTexture,n.attach(0)),Me.viewport(0,0,t.width,t.height),Pe(t),n=t}Me.disable(Me.BLEND),Me.useProgram(Ce.bloomFinal.program),Me.uniform2f(Ce.bloomFinal.uniforms.texelSize,n.texelSizeX,n.texelSizeY),Me.uniform1i(Ce.bloomFinal.uniforms.uTexture,n.attach(0)),Me.uniform1f(Ce.bloomFinal.uniforms.intensity,ie.BLOOM_INTENSITY),Pe(t)}(Ue.read,ke),function(e){const t=null==e?Me.drawingBufferWidth:e.width,n=null==e?Me.drawingBufferHeight:e.height;Me.useProgram(Ce.display.program),Me.uniform2f(Ce.display.uniforms.texelSize,1/t,1/n),Me.uniform1i(Ce.display.uniforms.uTexture,Ue.read.attach(0)),ie.BLOOM&&Ge.length>=2?(Me.uniform1i(Ce.display.uniforms.uBloom,ke.attach(1)),Me.uniform1i(Ce.display.uniforms.useBloom,1)):Me.uniform1i(Ce.display.uniforms.useBloom,0),Pe(e)}(r),requestAnimationFrame(t)}()}(t,r,i),e.dataset.fluidInitialized="true"})}window.initFluidGroupBlocks=e,document.addEventListener("DOMContentLoaded",e)})();